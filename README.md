================================================================================
                            AVITO RENTAL BOT
                              Автор: ZerX
================================================================================

Автоматический бот для работы с арендой недвижимости на Avito.
Мониторит новые сообщения от потенциальных арендаторов, собирает необходимую
информацию о клиентах и отправляет заявки в Telegram.

--------------------------------------------------------------------------------
ВОЗМОЖНОСТИ
--------------------------------------------------------------------------------

* Автоматический мониторинг новых сообщений на Avito
* Интеллектуальное общение с клиентами через GPT-4
* Сбор полной информации о потенциальных арендаторах
* Отправка структурированных заявок в Telegram
* Многопоточная обработка нескольких чатов одновременно
* Работа в режиме 24/7 на сервере

--------------------------------------------------------------------------------
СТРУКТУРА ПРОЕКТА
--------------------------------------------------------------------------------

avito-rental-bot/
├── main.py          Главный файл запуска
├── avito.py         Работа с Avito API
├── chat_gpt.py      Взаимодействие с OpenAI
├── telegram.py      Отправка уведомлений в Telegram
├── config.py        Настройки и конфигурация
├── deploy.sh        Скрипт развертывания на сервере
└── README.md        Документация проекта

--------------------------------------------------------------------------------
ПРИНЦИП РАБОТЫ
--------------------------------------------------------------------------------

[1] Бот каждые 60 секунд проверяет новые сообщения на Avito
[2] Отвечает только на сообщения, полученные не позднее 3 часов назад
[3] Через GPT-4 ведет диалог с клиентом, собирая необходимую информацию:
    - Состав жильцов (возраст, пол)
    - Наличие детей и животных
    - Срок аренды
    - Дата заселения
    - Контактные данные
[4] После сбора всей информации отправляет заявку в Telegram
[5] Каждый клиент обрабатывается в отдельном контексте

--------------------------------------------------------------------------------
ТРЕБОВАНИЯ
--------------------------------------------------------------------------------

+ Python 3.8+
+ Доступ к API Avito
+ API ключ OpenAI (GPT-4)
+ Telegram бот токен
+ Linux сервер (для продакшн развертывания)

--------------------------------------------------------------------------------
БЫСТРЫЙ СТАРТ
--------------------------------------------------------------------------------

>>> Получение API ключей

Avito API:
  1. Зарегистрируйтеся в Avito API
  2. Получите CLIENT_ID и CLIENT_SECRET
  3. Узнайте свой USER_ID

OpenAI API:
  1. Зарегистрируйтесь на platform.openai.com
  2. Создайте API ключ с доступом к GPT-4

Telegram Bot:
  1. Создайте бота через @BotFather
  2. Получите токен бота
  3. Узнайте ID чата для уведомлений

>>> Локальная установка

$ git clone <repository-url>
$ cd avito-rental-bot
$ python3 -m venv venv
$ source venv/bin/activate
$ pip install aiohttp openai

>>> Настройка конфигурации

Отредактируйте файл config.py:

# API ключи
OPENAI_API_KEY = "ваш_openai_api_ключ"
AVITO_USER_ID = ваш_avito_user_id
AVITO_CLIENT_ID = "ваш_avito_client_id"
AVITO_CLIENT_SECRET = "ваш_avito_client_secret"
TELEGRAM_BOT_TOKEN = "ваш_telegram_bot_token"
TELEGRAM_CHAT_ID = "id_чата_для_уведомлений"

# Настройки работы
CHECK_INTERVAL = 60  # интервал проверки в секундах
TIME_WINDOW_HOURS = 3  # окно времени для новых сообщений

>>> Запуск

$ python main.py

--------------------------------------------------------------------------------
РАЗВЕРТЫВАНИЕ НА СЕРВЕРЕ
--------------------------------------------------------------------------------

>>> Автоматическое развертывание

$ wget <deploy-script-url>/deploy.sh
$ chmod +x deploy.sh
$ sudo ./deploy.sh

>>> Ручная настройка

После автоматического развертывания:

$ scp -r * user@server:/home/user/avito-rental-bot/
$ ssh user@server
$ cd /home/user/avito-rental-bot

# Настройте config.py с вашими API ключами

$ ./bot_control.sh start    # Запуск бота
$ ./bot_control.sh status   # Проверка статуса
$ ./bot_control.sh logs     # Просмотр логов
$ ./bot_control.sh enable   # Включение автозапуска

--------------------------------------------------------------------------------
КОМАНДЫ УПРАВЛЕНИЯ
--------------------------------------------------------------------------------

./bot_control.sh start      Запустить бота
./bot_control.sh stop       Остановить бота
./bot_control.sh restart    Перезапустить бота
./bot_control.sh status     Показать статус
./bot_control.sh logs       Просмотр логов в реальном времени
./bot_control.sh enable     Включить автозапуск при загрузке системы
./bot_control.sh disable    Отключить автозапуск

--------------------------------------------------------------------------------
МОНИТОРИНГ И ЛОГИ
--------------------------------------------------------------------------------

# Просмотр всех логов
$ sudo journalctl -u avito-rental-bot

# Логи в реальном времени
$ sudo journalctl -u avito-rental-bot -f

# Логи за последний час
$ sudo journalctl -u avito-rental-bot --since "1 hour ago"

--------------------------------------------------------------------------------
БЕЗОПАСНОСТЬ
--------------------------------------------------------------------------------

* Все API ключи хранятся в config.py
* Не публикуйте файл config.py с настоящими ключами
* Используйте права пользователя (не root) для запуска бота
* Регулярно обновляйте зависимости

--------------------------------------------------------------------------------
УСТРАНЕНИЕ НЕПОЛАДОК
--------------------------------------------------------------------------------

[!] Бот не запускается
    1. Проверьте правильность API ключей в config.py
    2. Убедитесь, что все зависимости установлены
    3. Проверьте логи: ./bot_control.sh logs

[!] Бот не отвечает на сообщения
    1. Проверьте правильность AVITO_USER_ID
    2. Убедитесь, что у вас есть активные объявления
    3. Проверьте доступ к OpenAI API

[!] Уведомления не приходят в Telegram
    1. Проверьте TELEGRAM_BOT_TOKEN и TELEGRAM_CHAT_ID
    2. Убедитесь, что бот добавлен в чат
    3. Проверьте права бота на отправку сообщений

--------------------------------------------------------------------------------
ТЕХНИЧЕСКАЯ ПОДДЕРЖКА
--------------------------------------------------------------------------------

При возникновении проблем:
1. Проверьте логи бота
2. Убедитесь в правильности конфигурации
3. Проверьте доступность всех API

================================================================================
Версия: 1.0 | Автор: ZerX | Дата: 04.08.2025
================================================================================